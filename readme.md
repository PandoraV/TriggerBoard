/*********************************************************************************************
* 版本 v2.1
* Edition Date: 2021-03-03
* 
* 更新内容：
* 1. 移去看门狗部分
* 2. 非触发间隔最小为140μs，同时每个脉冲宽度为80μs（脉冲变压器为3：1）
* 3. 门极电流与擎住电流成负相关
* 4. 2系列版本加入分频
* --------------------------------------------------------------------------------------------
* 版本 v1.5.1
* Edition Date: 2021-12-06
* 
* 更新内容：
* 1. 检测50Hz逻辑优化除虫，对LED4重新驱动，进一步完善逻辑
* 2. 触发脉宽调整为300μs，尝试解决三极管发热问题
* 3. 50Hz对电磁干扰信号过滤时间提高到2ms
* 4. 分频除虫
* 5. 移除使能信号切换时间
* 
* --------------------------------------------------------------------------------------------
* 版本 v1.5
* Edition Date: 2021-04-12（03-02立项）
* 
* 更新内容：
* 1. 修正判断检测50Hz逻辑
* 2. 对代码做简化
* 3. 喂狗间隔改为1.5s
* 4. 启用触发控制角为2.5ms，优化触发角标志位复位逻辑
* 5. 触发脉宽调整至140μs
* 
* 计划更新：
* 1. 目前实验发现不喂狗也没有问题，需要研究清楚怎么回事。
* 
* 特别提示：
*    之前触发上升沿忘改了，所以造成了短路事故，下次接线时应当注意。
* --------------------------------------------------------------------------------------------
* 版本 v1.4.3
* Edition Date: 2021-02-03
* 
* 更新内容：
* 1. 修正50Hz分频的代码逻辑
* 2. 修正触发沿
* 3. 修正触发脉宽为200μs
* 
* 计划更新：
* 1. 目前实验发现不喂狗也没有问题，需要研究清楚怎么回事。
* --------------------------------------------------------------------------------------------
* 
* *分支*
* boardTest.ino v1.2.1 Edition Date: 2020-12-31
* 
* 更新内容：
* 1. 增加触发脉冲宽度至2ms（无用）
* --------------------------------------------------------------------------------------------
* *分支*
* boardTest.ino v1.2 Edition Date: 2020-12-30
* 
* 更新内容：
* 1. 单脉冲触发，通过复位键给脉冲
* --------------------------------------------------------------------------------------------
* 版本 v1.4.2
* Edition Date: 2020-12-12
* 
* 更新说明：
* 1. 重写frequency_division函数，给定频率1 2 ~3 ~4 5 ~6 ~8 10Hz
* 2. 触发信号脉宽改为120μs，必要时应改回1ms，需做测试；
* 3. 重新对触发判断上升沿作解释。
* 4. 完善50Hz信号源判断逻辑，对负半周期内判断补完
* 
* 特别提示：
*    由于这一版程序是**第一次高压上电**使用，因此务必注意安全，谨防晶闸管烧损和触电断路事故。注意事项
* 包括以下几点：
* 1. 首先给触发板上弱电和市电，了解拨码开关如何控制及其具体效果，务必将所有220V裸露元器件及接线口用绝缘
* 脚步粘牢，防止触电事故发生；拨动拨码开关时应注意防止触碰到下部元器件，谨防触电。务必使用隔离变压器引进
* 的220V电源。要验证触发沿是否符合电路原理。
* 2. 保证良好的散热与通风。触发板上三极管Q1因为承担触发脉冲开启关断的重任，通断电流极大，会发热。正常情
* 况下没有大碍，但如若散热条件较差，会引起Q1烧损。因为触发信号时间较短，晶闸管的导通正反馈可能较慢，应
* 避免晶闸管在较高阻态下过热烧毁。晶闸管的散热装置是全金属装置，其上携带高压，实验中**严禁触摸晶闸管**，
* 需要测温时请使用红外热成像仪。散热片之下应使用良好的绝缘体，例如环氧树脂作为底板，布线时避免搭线引起
* 短路事故。
* 祝你们实验顺利。
* --------------------------------------------------------------------------------------------
* 版本 v1.4
* Edition Date: 2020-10-21
* 
* 更新内容：
* 1. 使用Jump控制分频，从1分频到8分频
* 
* 计划更新：
* 1. 判断50Hz信号源的代码逻辑有问题
* 
* *分支*
* boardTest.ino v1.1 Edition Date: 2020-10-21
* 
* 更新内容：
* 1. 修正触发周期和触发脉宽；
* 2. AD调理电路和看门狗信号;
* 3. Trig_EN;
* --------------------------------------------------------------------------------------------
* 版本 v2.0
* Edition Date: 2020-08-26
* 
* 更新说明：
* 1. 单周期内增加脉冲个数，使用Jump控制
* 2. 将触发Trig单独存在一个函数内
* --------------------------------------------------------------------------------------------
* 版本 v1.3.3
* Edition Date: 2020-08-25
* 
* 更新说明：
* 1. 使用delay函数增加脉冲个数
* 
* 计划增加功能：
* 1. 计时增加脉冲个数
* 
* *分支*
* boardTest.ino v1.0 Created on 2020-05-24 Edition Date: 2020-05-25
* 
* 功能内容：
* 1. 不以输入频率做参考，输出50Hz频率信号。
* --------------------------------------------------------------------------------------------
* 版本 v1.3.2
* Edition Date: 2020-08-25
* 
* 更新说明：
* 1. 将触发信号宽度调整为微秒级,115μs。
* 
* 计划增加功能：
* 1. 增加脉冲个数
* --------------------------------------------------------------------------------------------
* 版本 v1.3.1
* Edition Date: 2020-08-24
* 
* 更新说明：
* 1. 修正Trig_EN导致的错误。
* 
* 计划增进功能：
* 1. 以计数为基础的分频函数。
* --------------------------------------------------------------------------------------------
* 版本 v1.3
* Edition Date: 2020-08-23
* 
* 更新说明：
* 1. 将上升下降沿判断用变量存储；
* 2. 加入微秒级控制。
* 3. 三个版本timeTest用于测试millis计时准确性。
* --------------------------------------------------------------------------------------------
* 版本 v1.2.4
* Edition Date: 2020-08-07
* 
* 更新说明：
* 1. 回归触发时刻取正负半波.
* 
* 计划增进功能：
* 1. 导通时间改成微秒级；
* 2. 触发控制角；
* 3. 微秒级溢出函数。
* --------------------------------------------------------------------------------------------
* 版本 v1.2.3
* 
* 更新说明：
* 1. 修正触发逻辑，trig_flag在判断时取反，解决无法进入低电平判断的问题；
* 2. 修正zero_flag问题，回归过零点重复记录修复前的zero_flag设定，解决触发期间三极管恒导通导致的三极管
* 烧毁问题。
* --------------------------------------------------------------------------------------------
* 版本 v1.2.2
* 
* 更新说明：
* 1. 更正引脚；
* 2. 将过零触发沿改回高到低
* --------------------------------------------------------------------------------------------
* 版本 v1.2.1
* 
* 更新说明：
* 1. Jump灯为低电平亮
* --------------------------------------------------------------------------------------------
* 版本 v1.2
* 
* 更新说明：
* 1. 修正触发时判断逻辑，防止过零点重复记录导致多次触发  
* 
* 计划增进功能：
* 1. 下个版本增加触发角控制功能,配合MicoMillis()溢出函数
* --------------------------------------------------------------------------------------------
* 版本 v1.1
* 
* 更新说明：
* 1. 加入了以Trig_EN配合Jump信号控制程序启停（频率）的初步策略
* 2. 电压过零点输入为TTL电平输入，不用analogRead，已订正
* 3. 优化溢出后触发静默的逻辑
* 
* 功能说明：
* 1. 增加了按时间控制的Trig_EN，之所以没在频率身上动手脚是因为单独控制Trig_EN比较危险，在较短的时间内
* 会导致其遮蔽Trig1信号，导致频率出现较大波动乃至于无法触发，不如直接对Trig1操作比较方便。
* 2. 折中的做法是降低调频的精度
* 
* 计划增进功能：
* 1. 下个版本增加触发角控制功能,配合MicoMillis()溢出函数
* --------------------------------------------------------------------------------------------
* 历史版本：
* 
* 版本 V1.0
* 
* 功能说明：
* 1. 能够检测电压过零点，时限1ms，在电压过零点长于10ms检测不到时会LED灯提示
* 2. WDI喂狗信号每100ms给一次，脉宽1ms
* 3. 触发信号根据电压过零信号决定，脉宽1ms
* 4. 对于millis()函数每50天溢出一次，设计了溢出函数对单片机内部各参量进行复位
* 
* 计划增进功能：
* 1. 使用millisMicro()函数对信号触发控制角进行改进，70min溢出一次
* 2. 触发使能信号Trig_EN尚待确定，这是杀菌控制策略的一部分，此版本内默认LOW
*********************************************************************************************/
